<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Digital - Sistema Cloud</title>
    <link rel="stylesheet" href="styles.css">
<script>
        // Detectar entorno desde el hostname
        document.addEventListener('DOMContentLoaded', () => {
            const hostname = window.location.hostname;
            let env = 'Producci√≥n';
            let emoji = 'üî¥';
            let color = '#ef4444';
            
            if (hostname.includes('-dev') || hostname.includes('dev.')) {
                env = 'Development';
                emoji = 'üü¢';
                color = '#10b981';
            } else if (hostname.includes('-staging') || hostname.includes('staging.')) {
                env = 'Staging';
                emoji = 'üü°';
                color = '#f59e0b';
            }
            
            const envElement = document.getElementById('entorno');
            if (envElement) {
                envElement.textContent = emoji + ' ' + env;
                envElement.style.color = color;
                envElement.style.fontWeight = 'bold';
            }
        });
    </script>
</head>
</head>
<body>
    <!-- Badge de Entorno -->
    <div id="environment-badge" style="
        position: fixed;
        top: 10px;
        right: 10px;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: bold;
        color: white;
        z-index: 1000;
        font-size: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        background-color: #666;
    ">
        Cargando...
    </div>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1>üìö Sistema de Biblioteca Digital</h1>
                <p class="subtitle">Gesti√≥n de Libros en la Nube - Proyecto PaaS</p>
            </div>
            <div class="header-info">
                <span class="badge-env">üåê Entorno: <strong id="entorno">Producci√≥n</strong></span>
            </div>
        </div>
    </header>

    <section class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card total">
                    <div class="stat-icon">üìñ</div>
                    <div class="stat-content">
                        <div class="stat-number" id="totalLibros">0</div>
                        <div class="stat-label">Total de Libros</div>
                    </div>
                </div>
                <div class="stat-card disponibles">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-content">
                        <div class="stat-number" id="disponibles">0</div>
                        <div class="stat-label">Disponibles</div>
                    </div>
                </div>
                <div class="stat-card prestados">
                    <div class="stat-icon">üì§</div>
                    <div class="stat-content">
                        <div class="stat-number" id="prestados">0</div>
                        <div class="stat-label">Prestados</div>
                    </div>
                </div>
                <div class="stat-card porcentaje">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-content">
                        <div class="stat-number" id="porcentaje">0%</div>
                        <div class="stat-label">Disponibilidad</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="search-section">
        <div class="container">
            <div class="search-box">
                <input type="text" id="busqueda" placeholder="üîç Buscar por t√≠tulo, autor o g√©nero..." />
                <button onclick="buscarLibros()" class="btn-search">Buscar</button>
                <button onclick="limpiarBusqueda()" class="btn-clear">Limpiar</button>
            </div>
        </div>
    </section>

    <section class="form-section">
        <div class="container">
            <div class="form-card">
                <h2>‚ûï Agregar Nuevo Libro al Cat√°logo</h2>
                <form id="formLibro" class="form-libro">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="titulo">
                                <span class="label-icon">üìñ</span>
                                T√≠tulo del Libro *
                            </label>
                            <input type="text" id="titulo" required placeholder="Ej: El Principito" />
                        </div>
                        
                        <div class="form-group">
                            <label for="autor">
                                <span class="label-icon">‚úçÔ∏è</span>
                                Autor *
                            </label>
                            <input type="text" id="autor" required placeholder="Ej: Antoine de Saint-Exup√©ry" />
                        </div>
                        
                        <div class="form-group">
                            <label for="a√±o">
                                <span class="label-icon">üìÖ</span>
                                A√±o de Publicaci√≥n *
                            </label>
                            <input type="number" id="a√±o" required placeholder="Ej: 1943" min="1000" max="2025" />
                        </div>
                        
                        <div class="form-group">
                            <label for="genero">
                                <span class="label-icon">üè∑Ô∏è</span>
                                G√©nero *
                            </label>
                            <input type="text" id="genero" required placeholder="Ej: Ficci√≥n, Terror, Romance" />
                        </div>
                        
                        <div class="form-group">
                            <label for="isbn">
                                <span class="label-icon">üî¢</span>
                                ISBN (Opcional)
                            </label>
                            <input type="text" id="isbn" placeholder="Ej: 978-0156012195" />
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-primary">
                        <span>‚ûï</span> Agregar Libro a la Biblioteca
                    </button>
                </form>
            </div>
        </div>
    </section>

    <section class="catalog-section">
        <div class="container">
            <h2 class="section-title">üìö Cat√°logo Completo de Libros</h2>
            
            <div id="mensajeVacio" class="mensaje-vacio" style="display: none;">
                <div class="empty-icon">üì≠</div>
                <h3>No hay libros en la biblioteca</h3>
                <p>¬°Agrega el primer libro usando el formulario de arriba!</p>
            </div>
            
            <div id="libros" class="books-grid"></div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p><strong>Sistema de Biblioteca Digital</strong></p>
                <p>Proyecto de Gesti√≥n en la Nube | Arquitectura PaaS</p>
                <p class="tech-stack">üöÄ Node.js + Express | üíæ Storage en Memoria | üåê Desplegado en Render</p>
            </div>
        </div>
    </footer>

    <script src="app.js">
    // Cargar informaci√≥n del entorno
    async function loadEnvironmentInfo() {
        try {
            const response = await fetch('/api/environment');
            const result = await response.json();
            
            if (result.success) {
                const badge = document.getElementById('environment-badge');
                badge.textContent = result.data.badge_text;
                badge.style.backgroundColor = result.data.badge_color;
                
                // Actualizar t√≠tulo de la p√°gina
                document.title = `Biblioteca Digital - ${result.data.name}`;
                
                console.log('üåç Entorno:', result.data.name);
                console.log('üìã Tabla:', result.data.table);
                console.log('‚ú® Features:', result.data.features);
            }
        } catch (error) {
            console.error('Error al cargar entorno:', error);
            document.getElementById('environment-badge').textContent = 'ERROR';
            document.getElementById('environment-badge').style.backgroundColor = '#dc3545';
        }
    }

    // Cargar entorno al inicio
    loadEnvironmentInfo();

    // Estado de la aplicaci√≥n
    let libros = [];
</script>
</body>
</html>
